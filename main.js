const song="audio.mp3",audio=new Audio(song);let isAudioPlaying=!1,isTranslated=!1;const container=document.querySelector(".container"),playBtn=document.getElementById("play-btn"),progressTruck=document.querySelector(".progress-truck"),progressBar=document.querySelector(".progress-bar"),overlay=document.getElementById("audio-overlay"),restartButton=document.getElementById("restart-audio");function togglePlayPauseForAll(e){friends.forEach((t=>{const o=t.querySelector(".controls span:nth-child(1)");e?(o.innerHTML='<i class="fas fa-pause"></i>',o.style.backgroundColor="#007bff",o.style.color="#fff"):(o.innerHTML='<i class="fas fa-play"></i>',o.style.backgroundColor="#fff",o.style.color="#202020")}))}const friends=document.querySelectorAll(".friend");function rearrangeFriends(){const e=document.querySelector(".container"),t=Array.from(document.querySelectorAll(".friend"));t.sort(((e,t)=>{const o=e.querySelector(".friend-name").textContent.toUpperCase(),n=t.querySelector(".friend-name").textContent.toUpperCase();return o<n?-1:o>n?1:0})),t.forEach((t=>{e.removeChild(t)})),t.forEach((t=>{e.appendChild(t)}))}function scrollToTime(){const e=container.scrollHeight-container.clientHeight,t=audio.currentTime/audio.duration*e;container.scrollTo({top:t,behavior:"smooth"});const o=audio.currentTime/audio.duration*100;progressBar.style.width=o+"%"}function showNotification(e){const t=document.getElementById("notification-container");t.textContent=e,t.style.display="block",setTimeout((()=>{t.style.display="none"}),3e3)}friends.forEach(((e,t)=>{const o=[],n=e.querySelector(".controls span:nth-child(1)"),i=e.querySelector(".controls span:nth-child(2)"),a=e.querySelector(".controls span:nth-child(3)"),r=e.querySelector(".controls span:nth-child(4)");n.addEventListener("click",(()=>{isAudioPlaying=!isAudioPlaying,isAudioPlaying?audio.play():audio.pause(),togglePlayPauseForAll(isAudioPlaying)})),i.addEventListener("click",(()=>{console.log(`Contact button clicked in Friend ${t+1}`),showNotification(`${e.querySelector(".friend-name").textContent}, contact not added`),audio.pause(),togglePlayPauseForAll(!1),isAudioPlaying=!1})),a.addEventListener("click",(()=>{isAudioPlaying=!isAudioPlaying,audio.muted=isAudioPlaying,friends.forEach((e=>{e.querySelector(".controls span:nth-child(3)").classList.toggle("muted",isAudioPlaying)})),a.classList.toggle("muted",isAudioPlaying)})),r.addEventListener("click",(()=>{isTranslated=!isTranslated;e.querySelectorAll(".friend-description p").forEach(((e,t)=>{isTranslated?(o[t]=o[t]||e.textContent,e.textContent=e.getAttribute("data-italian")||e.textContent):e.textContent=o[t]||e.textContent})),r.classList.toggle("translating",isTranslated),audio.pause(),togglePlayPauseForAll(!1),isAudioPlaying=!1}))})),rearrangeFriends(),audio.addEventListener("timeupdate",scrollToTime),playBtn.addEventListener("click",(()=>{audio.paused?(audio.play(),playBtn.innerHTML='<i class="fas fa-pause"></i>',isAudioPlaying=!0):(audio.pause(),playBtn.innerHTML="â–¶",isAudioPlaying=!1),togglePlayPauseForAll(isAudioPlaying),audio.addEventListener("ended",(()=>{console.log("Audio has ended"),togglePlayPauseForAll(!1),isAudioPlaying=!1,setTimeout((()=>{overlay.style.display="flex",container.scrollTop=0}),5e3)}))})),restartButton.addEventListener("click",(()=>{audio.currentTime=0,audio.play(),overlay.style.display="none",playBtn.innerHTML='<i class="fas fa-pause"></i>',togglePlayPauseForAll(!0),isAudioPlaying=!0})),audio.addEventListener("seeked",scrollToTime),progressTruck.addEventListener("click",(e=>{const t=progressTruck.clientWidth,o=e.offsetX/t*audio.duration;audio.currentTime=o}));
