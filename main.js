const song="audio.mp3",audio=new Audio(song);let isAudioPlaying=!1,isTranslated=!1;const originalTexts=[],container=document.querySelector(".container"),playBtn=document.getElementById("play-btn"),progressTruck=document.querySelector(".progress-truck"),progressBar=document.querySelector(".progress-bar"),overlay=document.getElementById("audio-overlay"),restartButton=document.getElementById("restart-audio"),friends=document.querySelectorAll(".friend");function rearrangeFriends(){const e=document.querySelector(".container"),t=Array.from(document.querySelectorAll(".friend"));t.sort(((e,t)=>{const n=e.querySelector(".friend-name").textContent.toUpperCase(),i=t.querySelector(".friend-name").textContent.toUpperCase();return n<i?-1:n>i?1:0})),t.forEach((t=>{e.removeChild(t)})),t.forEach((t=>{e.appendChild(t)}))}function scrollToTime(){const e=container.scrollHeight-container.clientHeight,t=audio.currentTime/audio.duration*e;container.scrollTo({top:t,behavior:"smooth"});const n=audio.currentTime/audio.duration*100;progressBar.style.width=n+"%"}function showNotification(e){const t=document.getElementById("notification-container");t.textContent=e,t.style.display="block",setTimeout((()=>{t.style.display="none"}),3e3)}friends.forEach(((e,t)=>{const n=e.querySelector(".controls span:nth-child(1)"),i=e.querySelector(".controls span:nth-child(2)"),o=e.querySelector(".controls span:nth-child(3)"),a=e.querySelector(".controls span:nth-child(4)");n.addEventListener("click",(()=>{console.log(`Pause button clicked in Friend ${t+1}`),isAudioPlaying=!isAudioPlaying,isAudioPlaying?(audio.pause(),n.innerHTML='<i class="fas fa-play"></i>'):(audio.play(),n.innerHTML='<i class="fas fa-pause"></i>')})),i.addEventListener("click",(()=>{console.log(`Contact button clicked in Friend ${t+1}`),showNotification(`${e.querySelector(".friend-name").textContent}, contact not added`),audio.pause(),n.innerHTML='<i class="fas fa-play"></i>',isAudioPlaying=!1})),o.addEventListener("click",(()=>{isAudioPlaying=!isAudioPlaying,audio.muted=isAudioPlaying,friends.forEach((e=>{e.querySelector(".controls span:nth-child(3)").classList.toggle("muted",isAudioPlaying)})),o.classList.toggle("muted",isAudioPlaying)})),a.addEventListener("click",(()=>{isTranslated=!isTranslated;e.querySelectorAll(".friend-description p").forEach(((e,t)=>{isTranslated?(originalTexts[t]=originalTexts[t]||e.textContent,e.textContent=e.getAttribute("data-italian")||e.textContent):e.textContent=originalTexts[t]||e.textContent}));e.querySelector(".controls span:nth-child(4)").classList.toggle("translating",isTranslated),a.classList.toggle("translating",isTranslated),audio.pause(),isAudioPlaying=!1,n.innerHTML='<i class="fas fa-play"></i>'}))})),rearrangeFriends(),audio.addEventListener("timeupdate",scrollToTime),playBtn.addEventListener("click",(()=>{audio.paused?(playBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i>',setTimeout((()=>{playBtn.innerHTML='<i class="fas fa-pause"></i>',audio.play()}),2e3),isAudioPlaying=!0):(audio.pause(),playBtn.textContent="â–¶",isAudioPlaying=!1),audio.addEventListener("ended",(()=>{console.log("Audio has ended"),isAudioPlaying=!1,friends.forEach((e=>{e.querySelector(".controls span:nth-child(1)").innerHTML='<i class="fas fa-play"></i>'})),setTimeout((()=>{overlay.style.display="flex",container.scrollTop=0}),3e3)}))})),restartButton.addEventListener("click",(()=>{audio.currentTime=0,audio.play(),overlay.style.display="none",playBtn.innerHTML='<i class="fas fa-pause"></i>',isAudioPlaying=!0})),audio.addEventListener("seeked",scrollToTime),progressTruck.addEventListener("click",(e=>{const t=progressTruck.clientWidth,n=e.offsetX/t*audio.duration;audio.currentTime=n}));
